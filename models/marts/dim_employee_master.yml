version: 2

models:
  - name: dim_employee_master
    description: "Model that displays employee and department infrmation"
    columns:
      - name: businessentityid
        description: "{{ doc('businessentityid') }}"
        data_tests:
          - unique
          - not_null
      - name: org
        description: "{{ doc('org') }}"
        tests:
          - not_null:
              config:
                where: "organizationlevel != 0"
      - name: organizationlevel
        description: "{{ doc('organizationlevel') }}"
        data_tests:
          - accepted_values:
              values: [0,1, 2, 3, 4]
          - not_null
      - name: birthdate
        description: "{{doc('birthdate') }}"
        data_tests:
          - not_null
      - name: gender
        description: "{{ doc('gender') }}"
        data_tests:
          - not_null
      - name: hiredate
        description: "{{doc('hiredate') }}"
        data_tests:
          - not_null
      - name: seniority_category
        description: "{{doc('seniority_category') }}"
        data_tests:
          - not_null
      - name: age_in_years
        description: "{{doc('age_in_years') }}"
        data_tests:
          - not_null
      - name: full_name
        description: "{{doc('full_name') }}"
        data_tests:
          - not_null

      - name: departmentid
        description: "{{doc('department_id') }}"
        data_tests:
          - not_null
      - name: department_name
        description: "{{doc('department_name') }}"
        data_tests:
          - not_null
      - name: business_unit
        description: "{{doc('business_unit') }}"
        data_tests:
          - not_null
      - name: startdate
        description: "{{doc('startdate') }}"
        data_tests:
          - not_null
      - name: enddate
        description: "{{doc('enddate') }}"
                     